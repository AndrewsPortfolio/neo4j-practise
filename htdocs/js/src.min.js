function logDebug(e,t){showDebug&&console.log(e+" : "+t)}function extractSingleDataVue(e){return arr=[],e.forEach(function(e){arr.push(e._fields[0].properties)}),arr}function extractData(e,t=null){var r=[];return e.forEach(function(e,n){var s={};if(null!=e._fields[0]&&(s=e._fields[0].properties),null!=t)for(var a=0;a<t.length;a++)null!=e._fields[a+1]&&(s[t[a]]=e._fields[a+1].properties);r.push(s)}),r}function errorCheck(e){switch(e){case e.success:return!0;case e.dbError:case e.inputError:return!1;default:return!0}}function createUrl(e){return server.protocol+server.ip+":"+server.port+"/"+e}function popModel(e,t){var r={};return e.forEach(function(e){r[e]=parameters[e]}),r}function formToObj(e,t){var r={};return t.forEach(function(t){r[t]=e[t].value}),r}function searchData(e,t,r){for(var n=0;n<r.length;n++)if(r[n][t]===e)return r[n]}function findData(e,t,r){for(var n=0;n<r.length;n++)if(r[n][t]===e)return n}function checkVar(e){return void 0===e}var departments,employees,showDebug=!0,codes={success:1,dbError:2,inputError:3,unknown:4},server={protocol:"http://",ip:"127.0.0.1",port:"1337"};Vue.mixin({data:function(){return{get employeeModel(){return["first_name","surename","email","job_title"]},get empExtras(){return["department","manager"]},get departmentModel(){return["name","description"]},get depExtras(){return["count"]}}}}),Vue.component("dep-select",{props:{deps:{type:Array},value:{type:Number}},template:'<select class="form-control" v-bind:value="value" v-on:change="updateValue($event.target.value)"><option v-for="(dep, i) in deps" v-bind:value="i">{{dep.name}}</option></select>',methods:{updateValue:function(e){this.$emit("input",Number(e))}}}),Vue.component("emp-select",{props:{emps:{type:Array},value:{type:Number},set:{type:Number}},template:'<select class="form-control" ref="input" v-bind:value="value" v-on:change="updateValue($event.target.value)"><option v-for="(emp, i) in emps" v-if="i != set" v-bind:value="i">{{emp.first_name}} {{emp.surename}}</option></select>',methods:{updateValue:function(e){this.$emit("input",Number(e))}}});var app=new Vue({el:"#e_controller",data:{test_app:0,departments:[],employees:[],assignDep:{e:0,d:0},assign:{m:{e:0,m:0},d:{e:0,d:0}}},created:function(){this.getDepartments(),this.getEmployees()},methods:{getDepartments:function(){this.$http.get(createUrl("departments")).then(e=>{errorCheck(e)?this.departments=extractData(e.body,null):console.log("data error : "+e)},e=>{}).bind(this)},getEmployees:function(){this.$http.get(createUrl("Employees")).then(e=>{errorCheck(e)?this.employees=extractData(e.body,this.empExtras):console.log("data error : "+e)},e=>{}).bind(this)},addDepartment:function(e){var t={name:e.target.elements.name.value,description:e.target.elements.description.value};this.$http.post(createUrl("addDepartment"),t).then(r=>{errorCheck(r)?(this.departments.push(t),e.target.reset()):console.log("data error : "+r)},e=>{}).bind(this)},addEmployee:function(e){var t=formToObj(e.target.elements,this.employeeModel);Vue.set(t,"department",this.departments[e.target.elements.department.value]),this.$http.post(createUrl("addEmployee"),t).then(r=>{errorCheck(r)?(this.employees.push(t),e.target.reset()):console.log("data error : "+r)},e=>{}).bind(this)},assignDepartment:function(e){var t=this.getEmployee(this.assign.d.e);Vue.set(t,"department",this.departments[this.assign.d.d]),this.$http.post(createUrl("assignDepartment"),t).then(r=>{errorCheck(r)?(Vue.set(this.employees,this.assign.d.e,t),e.target.reset()):console.log("data error : "+r)},e=>{}).bind(this)},assignManager:function(e){var t=this.employees[this.assign.m.e];Vue.set(t,"manager",this.employees[this.assign.m.m]),this.$http.post(createUrl("assignManager"),t).then(r=>{errorCheck(r)?(Vue.set(this.employees,this.assign.m.e,t),e.target.reset()):console.log("data error : "+r)},e=>{}).bind(this)},checkVar:function(e){return void 0===e},getEmployee:function(e){return this.employees[e]},getDepartment:function(e){return this.departments[e]},fullname:function(e){return this.employees[e]?this.employees[e].first_name+" "+this.employees[e].surename:""},test:function(){console.log("assignManager"),console.log("emp : "+this.assign.m.e),console.log("mgr : "+this.assign.m.m),console.log("test"),console.log("test_app : "+this.test_app)}}});